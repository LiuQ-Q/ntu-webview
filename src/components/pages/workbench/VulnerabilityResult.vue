<template>
  <b-container>
    <div class="mb-5">
      <h1>漏洞扫描结果</h1>
    </div>

    <b-table
      :fields="[
        { key: 'mark', label: '标识' },
        { key: 'library', label: '组件' },
        { key: 'module', label: '模组' },
        { key: 'version', label: '版本' },
        { key: 'style', label: '问题类型' },
        { key: 'source', label: '问题来源' },
        { key: 'score', label: '综合打分' },
        { key: 'detail', label: '详情' },
        { key: 'check', label: '选择' },
      ]"
      :items="vulnerabilityResult"
      class="text-center"
    >
      <template slot="thead-top">
        <tr>
          <th>
            <h5>问题列表</h5>
          </th>
          <th colspan="6">&nbsp;</th>
          <th>
            <b-dropdown 
              text="操作" 
              :disabled="vulnerabilitiesChecked.length === 0 ? true : false"
            >
              <b-dropdown-item>压制</b-dropdown-item>
              <b-dropdown-item>解除压制</b-dropdown-item>
            </b-dropdown>
          </th>
          <th>
            <b-dropdown text="下载">
              <b-dropdown-item>JSON</b-dropdown-item>
              <b-dropdown-item>PDF</b-dropdown-item>
              <b-dropdown-item>XML</b-dropdown-item>
              <b-dropdown-item>CSV</b-dropdown-item>
            </b-dropdown>
          </th>
        </tr>  
      </template>

      <template slot="mark" slot-scope="data">
        <b-link>{{ data.item.mark }}</b-link>
      </template>

      <template slot="detail">
        <b-link to='/projects/1/vulnerabilities/1/issue/1'>查看</b-link>
      </template>

      <template slot="check" slot-scope="data">
        <b-checkbox 
          v-model="vulnerabilitiesChecked"
          :value="data.item.mark"
        ></b-checkbox>
      </template>
    </b-table>
  </b-container>
</template>

<script>
export default {
  data() {
    return {
      vulnerabilitiesChecked: [],
      vulnerabilityResult: [
        {
          mark: 'CVE-2018-1111',
          library: 'ffmpeg',
          module: '0.elf',
          version: '1.1.1',
          style: 'CVE',
          source: '二进制',
          score: '8.8',
        },
        {
          mark: 'CVE-2018-2222',
          library: 'ffmpeg',
          module: '0.elf',
          version: '1.1.1',
          style: 'CVE',
          source: '二进制',
          score: '8.8',
        },
        {
          mark: 'CVE-2018-3333',
          library: 'ffmpeg',
          module: '0.elf',
          version: '1.1.1',
          style: 'CVE',
          source: '二进制',
          score: '8.8',
        },
      ]
    }
  }
}
</script>

<style>

</style>
